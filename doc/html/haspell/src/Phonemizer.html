<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Phonemizer</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Phonemizer</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span class="hs-comment">--for converting text into phones</span><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toLower</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><a href="HspInterpreter.html"><span class="hs-identifier">HspInterpreter</span></a><span> </span><span class="hs-special">(</span><a href="HspInterpreter.html#Phone"><span class="hs-identifier hs-type">Phone</span></a><span class="hs-special">,</span><a href="HspInterpreter.html#langRules"><span class="hs-identifier hs-var">langRules</span></a><span class="hs-special">,</span><span> </span><a href="HspInterpreter.html#LangRule"><span class="hs-identifier hs-type">LangRule</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HspInterpreter.html#AliasRule"><span class="hs-identifier hs-type">AliasRule</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HspInterpreter.html#aliasRules"><span class="hs-identifier hs-var">aliasRules</span></a><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- |Given the ID of language and a String returns a list of &quot;words&quot; - lists of phones</span><span>
</span><a name="line-7"></a><span class="hs-identifier">phonemize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ ID of language - for example &quot;p</span><span>
</span><a name="line-8"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ String to translate into words</span><span>
</span><a name="line-9"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HspInterpreter.html#Phone"><span class="hs-identifier hs-type">Phone</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-10"></a><a name="phonemize"><a href="Phonemizer.html#phonemize"><span class="hs-identifier">phonemize</span></a></a><span> </span><a name="local-1627429947"><a href="#local-1627429947"><span class="hs-identifier">lang</span></a></a><span> </span><a name="local-1627429948"><a href="#local-1627429948"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-1627429958"><a href="#local-1627429958"><span class="hs-identifier">wrds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">words</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><a href="#local-1627429948"><span class="hs-identifier hs-var">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>        </span><a name="local-1627430237"><a href="#local-1627430237"><span class="hs-identifier">als</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HspInterpreter.html#aliasRules"><span class="hs-identifier hs-var">aliasRules</span></a><span> </span><a href="#local-1627429947"><span class="hs-identifier hs-var">lang</span></a><span>
</span><a name="line-13"></a><span>        </span><a name="local-1627430238"><a href="#local-1627430238"><span class="hs-identifier">rlz</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HspInterpreter.html#langRules"><span class="hs-identifier hs-var">langRules</span></a><span> </span><a href="#local-1627429947"><span class="hs-identifier hs-var">lang</span></a><span>
</span><a name="line-14"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-1627430239"><a href="#local-1627430239"><span class="hs-identifier">phnmzd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-1627429949"><span class="hs-identifier hs-var">phonemize'</span></a><span> </span><a href="#local-1627430238"><span class="hs-identifier hs-var">rlz</span></a><span> </span><a href="#local-1627430237"><span class="hs-identifier hs-var">als</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627429958"><span class="hs-identifier hs-var">wrds</span></a><span>
</span><a name="line-15"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627430239"><span class="hs-identifier hs-var">phnmzd</span></a><span>
</span><a name="line-16"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span>
</span><a name="line-17"></a><span>            </span><span class="hs-identifier">phonemize'</span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HspInterpreter.html#LangRule"><span class="hs-identifier hs-type">LangRule</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HspInterpreter.html#AliasRule"><span class="hs-identifier hs-type">AliasRule</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HspInterpreter.html#Phone"><span class="hs-identifier hs-type">Phone</span></a><span class="hs-special">]</span><span>
</span><a name="line-18"></a><span>            </span><a name="local-1627429949"><a href="#local-1627429949"><span class="hs-identifier">phonemize'</span></a></a><span> </span><a name="local-1627429950"><a href="#local-1627429950"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627429951"><a href="#local-1627429951"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627429952"><a href="#local-1627429952"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">=</span><span>
</span><a name="line-19"></a><span>                </span><span class="hs-keyword">let</span><span> </span><span>
</span><a name="line-20"></a><span>                </span><a name="local-1627429953"><a href="#local-1627429953"><span class="hs-identifier">rest</span></a></a><span> </span><a name="local-1627429954"><a href="#local-1627429954"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627429955"><a href="#local-1627429955"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">token</span><span> </span><a href="#local-1627429954"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627429955"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-21"></a><span>                </span><span class="hs-keyword">in</span><span> </span><span>
</span><a name="line-22"></a><span>                </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-1627429952"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-23"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-24"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-25"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627429956"><a href="#local-1627429956"><span class="hs-identifier">rst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627429949"><span class="hs-identifier hs-var">phonemize'</span></a><span> </span><a href="#local-1627429950"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1627429951"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627429953"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="Phonemizer.html#matchLangRule"><span class="hs-identifier hs-var">matchLangRule</span></a><span> </span><a href="#local-1627429952"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-1627429950"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627429952"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-26"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627429957"><a href="#local-1627429957"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">phones</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Phonemizer.html#matchLangRule"><span class="hs-identifier hs-var">matchLangRule</span></a><span> </span><a href="#local-1627429952"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-1627429950"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-1627429956"><span class="hs-identifier hs-var">rst</span></a><span>
</span><a name="line-27"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><a href="Phonemizer.html#considerAliases"><span class="hs-identifier hs-var">considerAliases</span></a><span> </span><a href="#local-1627429951"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1627429957"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- |Given a String and a list of LangRules returns the LangRule whose token is the same as the beginning of the String</span><span>
</span><a name="line-30"></a><span class="hs-identifier">matchLangRule</span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ String to match the token of langRule to</span><span>
</span><a name="line-31"></a><span>			 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LangRule</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of available langRules to match to</span><span>
</span><a name="line-32"></a><span>			  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LangRule</span><span> </span><span class="hs-comment">-- ^ Matched langRule</span><span>
</span><a name="line-33"></a><a name="matchLangRule"><a href="Phonemizer.html#matchLangRule"><span class="hs-identifier">matchLangRule</span></a></a><span> </span><a name="local-1627430240"><a href="#local-1627430240"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HspInterpreter.html#MkLangRule"><span class="hs-identifier hs-var">MkLangRule</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-1627430240"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-34"></a><span class="hs-identifier">matchLangRule</span><span> </span><a name="local-1627430241"><a href="#local-1627430241"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627430242"><a href="#local-1627430242"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1627430243"><a href="#local-1627430243"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627430244"><span class="hs-identifier hs-var">matching</span></a><span> </span><a href="#local-1627430242"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-1627430242"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="Phonemizer.html#matchLangRule"><span class="hs-identifier hs-var">matchLangRule</span></a><span> </span><a href="#local-1627430241"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627430243"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>        </span><a name="local-1627430244"><a href="#local-1627430244"><span class="hs-identifier">matching</span></a></a><span> </span><a name="local-1627430245"><a href="#local-1627430245"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-1627430241"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">token</span><span> </span><a href="#local-1627430245"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>                     </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="#local-1627430241"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">token</span><span> </span><a href="#local-1627430245"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- |Modifies the list of phones based on AliasRules</span><span>
</span><a name="line-42"></a><span class="hs-identifier">considerAliases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HspInterpreter.html#AliasRule"><span class="hs-identifier hs-type">AliasRule</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of aliasRules to consider </span><span>
</span><a name="line-43"></a><span>				</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Phone</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Word to modify based on aliasRules</span><span>
</span><a name="line-44"></a><span>				</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Phone</span><span class="hs-special">]</span><span>
</span><a name="line-45"></a><a name="considerAliases"><a href="Phonemizer.html#considerAliases"><span class="hs-identifier">considerAliases</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-46"></a><span class="hs-identifier">considerAliases</span><span> </span><a name="local-1627430246"><a href="#local-1627430246"><span class="hs-identifier">rules</span></a></a><span> </span><a name="local-1627430247"><a href="#local-1627430247"><span class="hs-identifier">phones</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-1627430248"><span class="hs-identifier hs-var">didntmatch</span></a><span> </span><a href="#local-1627430249"><span class="hs-identifier hs-var">didmatch</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Phonemizer.html#matchAliasRule"><span class="hs-identifier hs-var">matchAliasRule</span></a><span> </span><a href="#local-1627430247"><span class="hs-identifier hs-var">phones</span></a><span> </span><a href="#local-1627430246"><span class="hs-identifier hs-var">rules</span></a><span>
</span><a name="line-47"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>            </span><a name="local-1627430248"><a href="#local-1627430248"><span class="hs-identifier">didntmatch</span></a></a><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-1627430247"><span class="hs-identifier hs-var">phones</span></a><span class="hs-special">]</span><span class="hs-operator hs-var">++</span><span class="hs-special">(</span><a href="Phonemizer.html#considerAliases"><span class="hs-identifier hs-var">considerAliases</span></a><span> </span><a href="#local-1627430246"><span class="hs-identifier hs-var">rules</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-1627430247"><span class="hs-identifier hs-var">phones</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>            </span><a name="local-1627430249"><a href="#local-1627430249"><span class="hs-identifier">didmatch</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627430251"><a href="#local-1627430251"><span class="hs-identifier">rule</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Phonemizer.html#considerAliases"><span class="hs-identifier hs-var">considerAliases</span></a><span> </span><a href="#local-1627430246"><span class="hs-identifier hs-var">rules</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-1627430251"><span class="hs-identifier hs-var">rule</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">++</span><span class="hs-special">(</span><a href="#local-1627430250"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="#local-1627430251"><span class="hs-identifier hs-var">rule</span></a><span> </span><a href="#local-1627430247"><span class="hs-identifier hs-var">phones</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>            </span><a name="local-1627430250"><a href="#local-1627430250"><span class="hs-identifier">rest</span></a></a><span> </span><a name="local-1627430252"><a href="#local-1627430252"><span class="hs-identifier">aliasrule</span></a></a><span> </span><a name="local-1627430253"><a href="#local-1627430253"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">regex</span><span> </span><a href="#local-1627430252"><span class="hs-identifier hs-var">aliasrule</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627430253"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- |Given a word (a list of phones) and a list of AliasRules returns the AliasRule whose regex is the same as the beginning of the word</span><span>
</span><a name="line-53"></a><span class="hs-identifier">matchAliasRule</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HspInterpreter.html#Phone"><span class="hs-identifier hs-type">Phone</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ List of phones to match the token of aliasRule to</span><span>
</span><a name="line-54"></a><span>				</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">AliasRule</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of available aliasRules to consider</span><span>
</span><a name="line-55"></a><span>				</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">AliasRule</span><span> </span><span class="hs-comment">-- ^ Matched langRule</span><span>
</span><a name="line-56"></a><a name="matchAliasRule"><a href="Phonemizer.html#matchAliasRule"><span class="hs-identifier">matchAliasRule</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-57"></a><span class="hs-identifier">matchAliasRule</span><span> </span><a name="local-1627430275"><a href="#local-1627430275"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627430276"><a href="#local-1627430276"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1627430277"><a href="#local-1627430277"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627430278"><span class="hs-identifier hs-var">matching</span></a><span> </span><a href="#local-1627430276"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-1627430276"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="Phonemizer.html#matchAliasRule"><span class="hs-identifier hs-var">matchAliasRule</span></a><span> </span><a href="#local-1627430275"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627430277"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>        </span><a name="local-1627430278"><a href="#local-1627430278"><span class="hs-identifier">matching</span></a></a><span> </span><a name="local-1627430279"><a href="#local-1627430279"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-1627430275"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">regex</span><span> </span><a href="#local-1627430279"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>                     </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="#local-1627430275"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">regex</span><span> </span><a href="#local-1627430279"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a></pre></body></html>